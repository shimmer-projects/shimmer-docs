<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src\site\asciidoc/h5\vue3-communication.adoc at 2024-05-17
 | Rendered using Apache Maven Fluido Skin 1.11.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>SHIMMER-DOCS &#x2013; </title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.11.0.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script src="../js/apache-maven-fluido-1.11.0.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h1>SHIMMER-DOCS</h1>
</div>
</div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">最近更新: 2024-05-17<span class="divider">|</span>
</li>
          <li id="projectVersion">版本: 0.0.1</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">SHIMMER</li>
    <li><a href="../index.html" title="初衷"><span class="none"></span>初衷</a></li>
    <li><a href="../shimmer/introduction.html" title="SHIMMER项目文档"><span class="icon-chevron-down"></span>SHIMMER项目文档</a>
     <ul class="nav nav-list">
      <li><a href="../shimmer/plan.html" title="开发计划"><span class="none"></span>开发计划</a></li>
      <li><a href="../shimmer/modules.html" title="模块说明"><span class="none"></span>模块说明</a></li>
      <li><a href="../shimmer/api-specification.html" title="API规范"><span class="none"></span>API规范</a></li>
      <li><a href="../shimmer/validation.html" title="参数校验"><span class="none"></span>参数校验</a></li>
      <li><a href="../shimmer/response-wrapper.html" title="响应包装"><span class="none"></span>响应包装</a></li>
      <li><a href="../shimmer/version.html" title="历史版本"><span class="none"></span>历史版本</a></li>
     </ul></li>
    <li><a href="../java/introduction.html" title="JAVA相关技术文档"><span class="icon-chevron-right"></span>JAVA相关技术文档</a></li>
    <li><a href="../h5/introduction.html" title="H5前端文档"><span class="icon-chevron-down"></span>H5前端文档</a>
     <ul class="nav nav-list">
      <li class="active"><a><span class="none"></span>Vue组件间通信/传值</a></li>
     </ul></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="构建依靠 Maven" class="poweredBy"><img class="builtBy" alt="构建依靠 Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<div id="toc" class="toc">
<div id="toctitle">目录</div>
<ul class="sectlevel1">
<li><a href="#vue组件间通信传值">1. Vue组件间通信/传值</a>
<ul class="sectlevel2">
<li><a href="#props">1.1. props</a></li>
<li><a href="#自定义事件">1.2. 自定义事件</a></li>
<li><a href="#bus总线">1.3. BUS总线</a></li>
<li><a href="#v_model">1.4. v-model</a></li>
<li><a href="#useattrs">1.5. useAttrs</a></li>
<li><a href="#refparent">1.6. ref$parent</a></li>
<li><a href="#provide_inject">1.7. provide-inject</a></li>
<li><a href="#pinia">1.8. pinia</a></li>
<li><a href="#slot">1.9. slot</a></li>
</ul>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="vue组件间通信传值">1. Vue组件间通信/传值</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="props">1.1. props</h3>
<div class="listingblock">
<div class="title">Parent.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="box"&gt;
    &lt;h1&gt;props:我是父组件曹操&lt;/h1&gt;
    &lt;hr /&gt;
    &lt;Child info="我是曹操" :money="money"&gt;&lt;/Child&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
//props:可以实现父子组件通信,props数据还是只读的！！！
import Child from "./Child.vue";
import { ref } from "vue";
let money = ref(10000);
&lt;/script&gt;

&lt;style scoped&gt;
.box {
  width: 100vw;
  height: 400px;
  background: yellowgreen;
}
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Child.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="son"&gt;
       &lt;h1&gt;我是子组件:曹植&lt;/h1&gt;
       &lt;p&gt;{{props.info}}&lt;/p&gt;
       &lt;p&gt;{{props.money}}&lt;/p&gt;
      &lt;!--props可以省略前面的名字---&gt;
       &lt;p&gt;{{info}}&lt;/p&gt;
       &lt;p&gt;{{money}}&lt;/p&gt;
       &lt;button @click="updateProps"&gt;修改props数据&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
//需要使用到defineProps方法去接受父组件传递过来的数据
//defineProps是Vue3提供方法,不需要引入直接使用
let props = defineProps(['info','money']); //数组|对象写法都可以
//按钮点击的回调
const updateProps = ()=&gt;{
  // props.money+=10;  props:只读的
  console.log(props.info)
}
&lt;/script&gt;

&lt;style scoped&gt;
.son{
  width: 400px;
  height: 200px;
  background: hotpink;
}
&lt;/style&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="自定义事件">1.2. 自定义事件</h3>
<div class="listingblock">
<div class="title">Parent.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div&gt;
    &lt;h1&gt;事件&lt;/h1&gt;
    &lt;!-- 原生DOM事件 --&gt;
    &lt;pre @click="handler"&gt;
      大江东去浪淘尽,千古分流人物
    &lt;/pre&gt;
    &lt;button @click="handler1(1,2,3,$event)"&gt;点击我传递多个参数&lt;/button&gt;
    &lt;hr&gt;
    &lt;!--
        vue2框架当中:这种写法自定义事件,可以通过.native修饰符变为原生DOM事件
        vue3框架下面写法其实即为原生DOM事件

        vue3:原生的DOM事件不管是放在标签身上、组件标签身上都是原生DOM事件
      --&gt;
    &lt;Child1 @click="handler2"&gt;&lt;/Child1&gt;
    &lt;hr&gt;
    &lt;!-- 绑定自定义事件xxx:实现子组件给父组件传递数据 --&gt;
    &lt;Child2 @xxx="handler3" @click="handler4"&gt;&lt;/Child2&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
//引入子组件
import Child1 from './Child1.vue';
//引入子组件
import Child2 from './Child2.vue';
//事件回调--1
const handler = (event)=&gt;{
    //event即为事件对象
    console.log(event);
}
//事件回调--2
const handler1 = (a,b,c,$event)=&gt;{
   console.log(a,b,c,$event)
}
//事件回调---3
const handler2 = ()=&gt;{
    console.log(123);
}
//事件回调---4
const handler3 = (param1,param2)=&gt;{
    console.log(param1,param2);
}
//事件回调--5
const handler4 = (param1,param2)=&gt;{
     console.log(param1,param2);
}
&lt;/script&gt;

&lt;style scoped&gt;
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Child1.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="son"&gt;
      &lt;p&gt;我是子组件1&lt;/p&gt;
      &lt;button&gt;点击我也执行&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;

&lt;/script&gt;

&lt;style scoped&gt;
.son{
  width: 400px;
  height: 200px;
  background: skyblue;
}
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Child2.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="child"&gt;
    &lt;p&gt;我是子组件2&lt;/p&gt;
    &lt;button @click="handler"&gt;点击我触发自定义事件xxx&lt;/button&gt;
    &lt;button @click="$emit('click','AK47','J20')"&gt;点击我触发自定义事件click&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
//利用defineEmits方法返回函数触发自定义事件
//defineEmits方法不需要引入直接使用
let $emit = defineEmits(['xxx','click']);
//按钮点击回调
const handler = () =&gt; {
  //第一个参数:事件类型 第二个|三个|N参数即为注入数据
    $emit('xxx','东风导弹','航母');
};
&lt;/script&gt;

&lt;style scoped&gt;
.child {
  width: 400px;
  height: 200px;
  background: pink;
}
&lt;/style&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bus总线">1.3. BUS总线</h3>
<div class="listingblock">
<div class="title">bus.ts</div>
<div class="content">
<pre class="highlight"><code class="language-typescript" data-lang="typescript">// pnpm install mitt
//引入mitt插件:mitt一个方法,方法执行会返回bus对象
import mitt from 'mitt';
const $bus = mitt();
export default $bus;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Parent.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="box"&gt;
    &lt;h1&gt;全局事件总线$bus&lt;/h1&gt;
    &lt;hr /&gt;
    &lt;div class="container"&gt;
      &lt;Child1&gt;&lt;/Child1&gt;
      &lt;Child2&gt;&lt;/Child2&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
//引入子组件
import Child1 from "./Child1.vue";
import Child2 from "./Child2.vue";
&lt;/script&gt;

&lt;style scoped&gt;
.box {
  width: 100vw;
  height: 400px;
  background: yellowgreen;
}
.container{
  display: flex;
  justify-content: space-between;
}
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Child1.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="child1"&gt;
    &lt;h3&gt;我是子组件1:曹植&lt;/h3&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import $bus from "../../bus";
//组合式API函数
import { onMounted } from "vue";
//组件挂载完毕的时候,当前组件绑定一个事件,接受将来兄弟组件传递的数据
onMounted(() =&gt; {
  //第一个参数:即为事件类型  第二个参数:即为事件回调
  $bus.on("car", (car) =&gt; {
    console.log(car);
  });
});
&lt;/script&gt;

&lt;style scoped&gt;
.child1 {
  width: 300px;
  height: 300px;
  background: hotpink;
}
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Child2.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="child2"&gt;
     &lt;h2&gt;我是子组件2:曹丕&lt;/h2&gt;
     &lt;button @click="handler"&gt;点击我给兄弟送一台法拉利&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
//引入$bus对象
import $bus from '../../bus';
//点击按钮回调
const handler = ()=&gt;{
  $bus.emit('car',{car:"法拉利"});
}
&lt;/script&gt;

&lt;style scoped&gt;
.child2{
  width: 300px;
  height: 300px;
  background: skyblue;
}
&lt;/style&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="v_model">1.4. v-model</h3>
<div class="listingblock">
<div class="title">Parent.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div&gt;
    &lt;h1&gt;v-model:钱数{{ money }}{{pageNo}}{{pageSize}}&lt;/h1&gt;
    &lt;input type="text" v-model="info" /&gt;
    &lt;hr /&gt;
    &lt;!-- props:父亲给儿子数据 --&gt;
    &lt;!-- &lt;Child :modelValue="money" @update:modelValue="handler"&gt;&lt;/Child&gt; --&gt;
    &lt;!--
       v-model组件身上使用
       第一:相当有给子组件传递props[modelValue] = 10000
       第二:相当于给子组件绑定自定义事件update:modelValue
     --&gt;
    &lt;Child1 v-model="money"&gt;&lt;/Child1&gt;
    &lt;hr /&gt;
    &lt;Child2 v-model:pageNo="pageNo" v-model:pageSize="pageSize"&gt;&lt;/Child2&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
//v-model指令:收集表单数据,数据双向绑定
//v-model也可以实现组件之间的通信,实现父子组件数据同步的业务
//父亲给子组件数据 props
//子组件给父组件数据 自定义事件
//引入子组件
import Child1 from "./Child1.vue";
import Child2 from "./Child2.vue";
import { ref } from "vue";
let info = ref("");
//父组件的数据钱数
let money = ref(10000);
//自定义事件的回调
const handler = (num) =&gt; {
  //将来接受子组件传递过来的数据
  money.value = num;
};

//父亲的数据
let pageNo = ref(1);
let pageSize = ref(3);
&lt;/script&gt;

&lt;style scoped&gt;
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Child1.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="child"&gt;
    &lt;h3&gt;钱数:{{ modelValue }}&lt;/h3&gt;
    &lt;button @click="handler"&gt;父子组件数据同步&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
//接受props
let props = defineProps(["modelValue"]);
let $emit = defineEmits(['update:modelValue']);
//子组件内部按钮的点击回调
const handler = ()=&gt;{
   //触发自定义事件
   $emit('update:modelValue',props.modelValue+1000);
}
&lt;/script&gt;

&lt;style scoped&gt;
.child {
  width: 600px;
  height: 300px;
  background: skyblue;
}
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Child2.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="child2"&gt;
    &lt;h1&gt;同时绑定多个v-model&lt;/h1&gt;
    &lt;button @click="handler"&gt;pageNo{{ pageNo }}&lt;/button&gt;
    &lt;button @click="$emit('update:pageSize', pageSize + 4)"&gt;
      pageSize{{ pageSize }}
    &lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
let props = defineProps(["pageNo", "pageSize"]);
let $emit = defineEmits(["update:pageNo", "update:pageSize"]);
//第一个按钮的事件回调
const handler = () =&gt; {
  $emit("update:pageNo", props.pageNo + 3);
};
&lt;/script&gt;

&lt;style scoped&gt;
.child2 {
  width: 300px;
  height: 300px;
  background: hotpink;
}
&lt;/style&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="useattrs">1.5. useAttrs</h3>
<div class="paragraph">
<p>attrs listeners</p>
</div>
<div class="listingblock">
<div class="title">Parent.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div&gt;
    &lt;h1&gt;useAttrs&lt;/h1&gt;
    &lt;el-button type="primary" size="small" :icon="Edit"&gt;&lt;/el-button&gt;
    &lt;!-- 自定义组件 --&gt;
    &lt;HintButton type="primary" size="small" :icon="Edit" title="编辑按钮" @click="handler" @xxx="handler"&gt;&lt;/HintButton&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
//vue3框架提供一个方法useAttrs方法,它可以获取组件身上的属性与事件！！！
//图标组件
import {
  Check,
  Delete,
  Edit,
  Message,
  Search,
  Star,
} from "@element-plus/icons-vue";
import HintButton from "./HintButton.vue";
//按钮点击的回调
const handler = ()=&gt;{
  alert(12306);
}
&lt;/script&gt;

&lt;style scoped&gt;
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">HintButton.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div :title="title"&gt;
     &lt;el-button :="$attrs"&gt;&lt;/el-button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
//引入useAttrs方法:获取组件标签身上属性与事件
import {useAttrs} from 'vue';
//此方法执行会返回一个对象
let $attrs = useAttrs();

//万一用props接受title
let props =defineProps(['title']);
//props与useAttrs方法都可以获取父组件传递过来的属性与属性值
//但是props接受了useAttrs方法就获取不到了
console.log($attrs);
&lt;/script&gt;

&lt;style scoped&gt;
&lt;/style&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="refparent">1.6. ref$parent</h3>
<div class="paragraph">
<p>ref children parent</p>
</div>
<div class="listingblock">
<div class="title">Parent.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="box"&gt;
    &lt;h1&gt;我是父亲曹操:{{money}}&lt;/h1&gt;
    &lt;button @click="handler"&gt;找我的儿子曹植借10元&lt;/button&gt;
    &lt;hr&gt;
    &lt;Child1 ref="son"&gt;&lt;/Child1&gt;
    &lt;hr&gt;
    &lt;Child2&gt;&lt;/Child2&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
//ref:可以获取真实的DOM节点,可以获取到子组件实例VC
//$parent:可以在子组件内部获取到父组件的实例
//引入子组件
import Child1 from './Child1.vue'
import Child2 from './Child2.vue'
import {ref} from 'vue';
//父组件钱数
let money = ref(100000000);
//获取子组件的实例
let son = ref();
//父组件内部按钮点击回调
const handler = ()=&gt;{
   money.value+=10;
   //儿子钱数减去10
   son.value.money-=10;
   son.value.fly();
}
//对外暴露
defineExpose({
   money
})
&lt;/script&gt;

&lt;style scoped&gt;
.box{
  width: 100vw;
  height: 500px;
  background: skyblue;
}
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Child1.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="son"&gt;
    &lt;h3&gt;我是子组件:曹植{{money}}&lt;/h3&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import {ref} from 'vue';
//儿子钱数
let money = ref(666);
const fly = ()=&gt;{
  console.log('我可以飞');
}
//组件内部数据对外关闭的，别人不能访问
//如果想让外部访问需要通过defineExpose方法对外暴露
defineExpose({
  money,
  fly
})
&lt;/script&gt;

&lt;style scoped&gt;
.son {
  width: 300px;
  height: 200px;
  background: cyan;
}
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Child2.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="dau"&gt;
     &lt;h1&gt;我是闺女曹杰{{money}}&lt;/h1&gt;
     &lt;button @click="handler($parent)"&gt;点击我爸爸给我10000元&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import {ref} from 'vue';
//闺女钱数
let money = ref(999999);
//闺女按钮点击回调
const handler = ($parent)=&gt;{
   money.value+=10000;
   $parent.money-=10000;
}
&lt;/script&gt;

&lt;style scoped&gt;
.dau{
  width: 300px;
  height: 300px;
  background: hotpink;
}
&lt;/style&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="provide_inject">1.7. provide-inject</h3>
<div class="listingblock">
<div class="title">Parent.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="box"&gt;
    &lt;h1&gt;Provide与Inject{{car}}&lt;/h1&gt;
    &lt;hr /&gt;
    &lt;Child&gt;&lt;/Child&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import Child from "./Child.vue";
//vue3提供provide(提供)与inject(注入),可以实现隔辈组件传递数据
import { ref, provide } from "vue";
let car = ref("法拉利");
//祖先组件给后代组件提供数据
//两个参数:第一个参数就是提供的数据key
//第二个参数:祖先组件提供数据
provide("TOKEN", car);
&lt;/script&gt;

&lt;style scoped&gt;
.box {
  width: 100vw;
  height: 600px;
  background: skyblue;
}
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Child.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="child"&gt;
     &lt;h1&gt;我是子组件1&lt;/h1&gt;
     &lt;GrandChild&gt;&lt;/GrandChild&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import GrandChild from './GrandChild.vue';
&lt;/script&gt;

&lt;style scoped&gt;
.child{
  width: 300px;
  height: 400px;
  background: yellowgreen;
}
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">GrandChild.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="child1"&gt;
    &lt;h1&gt;孙子组件&lt;/h1&gt;
    &lt;p&gt;{{car}}&lt;/p&gt;
    &lt;button @click="updateCar"&gt;更新数据&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import {inject} from 'vue';
//注入祖先组件提供数据
//需要参数:即为祖先提供数据的key
let car = inject('TOKEN');
const updateCar = ()=&gt;{
   car.value  = '自行车';
}
&lt;/script&gt;

&lt;style scoped&gt;
.child1 {
  width: 200px;
  height: 200px;
  background: red;
}
&lt;/style&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pinia">1.8. pinia</h3>
<div class="paragraph">
<p>集成pinia</p>
</div>
<div class="listingblock">
<div class="title">store/index.ts</div>
<div class="content">
<pre class="highlight"><code class="language-typescript" data-lang="typescript">// pnpm install pinia
//创建大仓库
import { createPinia } from 'pinia';
//createPinia方法可以用于创建大仓库
let store = createPinia();
//对外暴露,安装仓库
export default store;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">store/modules/info.ts</div>
<div class="content">
<pre class="highlight"><code class="language-typescript" data-lang="typescript">//定义info小仓库
import { defineStore } from "pinia";
//第一个仓库:小仓库名字  第二个参数:小仓库配置对象
//defineStore方法执行会返回一个函数,函数作用就是让组件可以获取到仓库数据
let useInfoStore = defineStore("info", {
    //存储数据:state
    state: () =&gt; {
        return {
            count: 99,
            arr: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
        }
    },
    actions: {
        //注意:函数没有context上下文对象
        //没有commit、没有mutations去修改数据
        updateNum(a: number, b: number) {
            this.count += a;
        }
    },
    getters: {
        total() {
            let result:any = this.arr.reduce((prev: number, next: number) =&gt; {
                return prev + next;
            }, 0);
            return result;
        }
    }
});
//对外暴露方法
export default useInfoStore;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">main.ts</div>
<div class="content">
<pre class="highlight"><code class="language-typescript" data-lang="typescript">// 引入实例化上下文的api方法createApp
import { createApp } from 'vue'
// 引入App组件
import App from './App.vue'
//引入仓库
import store from './store'
// 创建app
const app = createApp(App)
app.use(store)
// 挂载
app.mount('#app');</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Parent.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="box"&gt;
    &lt;h1&gt;pinia&lt;/h1&gt;
    &lt;div class="container"&gt;
      &lt;Child1&gt;&lt;/Child1&gt;
      &lt;Child2&gt;&lt;/Child2&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import Child1 from "./Child1.vue";
import Child2 from "./Child2.vue";
//vuex:集中式管理状态容器,可以实现任意组件之间通信！！！
//核心概念:state、mutations、actions、getters、modules

//pinia:集中式管理状态容器,可以实现任意组件之间通信！！！
//核心概念:state、actions、getters
//pinia写法:选择器API、组合式API
&lt;/script&gt;

&lt;style scoped&gt;
.box {
  width: 600px;
  height: 400px;
  background: skyblue;
}
.container{
  display: flex;
}
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Child1.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="child"&gt;
    &lt;h1&gt;{{ infoStore.count }}---{{infoStore.total}}&lt;/h1&gt;
    &lt;button @click="updateCount"&gt;点击我修改仓库数据&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import useInfoStore from "../../store/modules/info";
//获取小仓库对象
let infoStore = useInfoStore();
console.log(infoStore);
//修改数据方法
const updateCount = () =&gt; {
  //仓库调用自身的方法去修改仓库的数据
  infoStore.updateNum(66,77);
};
&lt;/script&gt;

&lt;style scoped&gt;
.child {
  width: 200px;
  height: 200px;
  background: yellowgreen;
}
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Child2.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="child1"&gt;
    {{ infoStore.count }}
    &lt;p @click="updateTodo"&gt;{{ todoStore.arr }}{{todoStore.total}}&lt;/p&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import useInfoStore from "../../store/modules/info";
//获取小仓库对象
let infoStore = useInfoStore();

//引入组合式API函数仓库
import useTodoStore from "../../store/modules/todo";
let todoStore = useTodoStore();

//点击p段落去修改仓库的数据
const updateTodo = () =&gt; {
  todoStore.updateTodo();
};
&lt;/script&gt;

&lt;style scoped&gt;
.child1 {
  width: 200px;
  height: 200px;
  background: hotpink;
}
&lt;/style&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="slot">1.9. slot</h3>
<div class="listingblock">
<div class="title">Parent.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div&gt;
    &lt;h1&gt;slot&lt;/h1&gt;
    &lt;Child2 :todos="todos"&gt;
      &lt;template v-slot="{ $row, $index }"&gt;
        &lt;p :style="{ color: $row.done ? 'green' : 'red' }"&gt;
          {{ $row.title }}--{{ $index }}
        &lt;/p&gt;
      &lt;/template&gt;
    &lt;/Child2&gt;
    &lt;Child1&gt;
      &lt;div&gt;
        &lt;pre&gt;大江东去浪淘尽,千古分流人物&lt;/pre&gt;
      &lt;/div&gt;
      &lt;!-- 具名插槽填充a --&gt;
      &lt;template #a&gt;
        &lt;div&gt;我是填充具名插槽a位置结构&lt;/div&gt;
      &lt;/template&gt;
      &lt;!-- 具名插槽填充b v-slot指令可以简化为# --&gt;
      &lt;template #b&gt;
        &lt;div&gt;我是填充具名插槽b位置结构&lt;/div&gt;
      &lt;/template&gt;
    &lt;/Child1&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import Child1 from "./Child1.vue";
import Child2 from "./Child2.vue";
//插槽:默认插槽、具名插槽、作用域插槽
//作用域插槽:就是可以传递数据的插槽,子组件可以讲数据回传给父组件,父组件可以决定这些回传的
//数据是以何种结构或者外观在子组件内部去展示！！！

import { ref } from "vue";
//todos数据
let todos = ref([
  { id: 1, title: "吃饭", done: true },
  { id: 2, title: "睡觉", done: false },
  { id: 3, title: "打豆豆", done: true },
  { id: 4, title: "打游戏", done: false },
]);
&lt;/script&gt;

&lt;style scoped&gt;
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Child1.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="box"&gt;
    &lt;h1&gt;我是子组件默认插槽&lt;/h1&gt;
    &lt;!-- 默认插槽 --&gt;
    &lt;slot&gt;&lt;/slot&gt;
    &lt;h1&gt;我是子组件默认插槽&lt;/h1&gt;
    &lt;h1&gt;具名插槽填充数据&lt;/h1&gt;
    &lt;slot name="a"&gt;&lt;/slot&gt;
    &lt;h1&gt;具名插槽填充数据&lt;/h1&gt;
    &lt;h1&gt;具名插槽填充数据&lt;/h1&gt;
    &lt;slot name="b"&gt;&lt;/slot&gt;
    &lt;h1&gt;具名插槽填充数据&lt;/h1&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
&lt;/script&gt;

&lt;style scoped&gt;
.box {
  width: 100vw;
  height: 500px;
  background: skyblue;
}
&lt;/style&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Child2.vue</div>
<div class="content">
<pre class="highlight"><code class="language-vue" data-lang="vue">&lt;template&gt;
  &lt;div class="box"&gt;
    &lt;h1&gt;作用域插槽&lt;/h1&gt;
    &lt;ul&gt;
      &lt;li v-for="(item, index) in todos" :key="item.id"&gt;
        &lt;!--作用域插槽:可以讲数据回传给父组件--&gt;
        &lt;slot :$row="item" :$index="index"&gt;&lt;/slot&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
//通过props接受父组件传递数据
defineProps(["todos"]);
&lt;/script&gt;

&lt;style scoped&gt;
.box {
  width: 100vw;
  height: 400px;
  background: skyblue;
}
&lt;/style&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2024
</p>
        </div>
      </div>
    </footer>
<script>
	if(anchors) {
	  anchors.add();
	}
</script>
  </body>
</html>
